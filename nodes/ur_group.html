<script type="text/javascript">
    // convert to i18 text
    function c_ur_group(x) {
        return RED._('unified-red/ur_group:ur_group.' + x);
    }

    RED.nodes.registerType('ur_group', {
        category: 'config',
        defaults: {
            name: { value: c_ur_group('label.default') },
            menuPage: { type: 'ur_menu_page', required: true },
            order: { value: 0 },
            disp: { value: true },
            // width: { value: 30 },
            // width: { value: { lg: 6, md: 6, sm: 12 } },
            widthLg: { value: 6 },
            widthMd: { value: 6 },
            widthSm: { value: 12 },
            collapse: { value: false },
            disabled: { value: false },
            hidden: { value: false },
            access: { value: '' },
        },
        sort: function (A, B) {
            if (A.menuPage !== B.menuPage) {
                var menuPageA = RED.nodes.node(A.menuPage);
                var menuPageB = RED.nodes.node(B.menuPage);
                if (!menuPageA && menuPageB) {
                    return -1;
                } else if (menuPageA && !menuPageB) {
                    return 1;
                } else {
                    return menuPageA.order - menuPageB.order;
                }
            }
            return A.order - B.order;
        },
        paletteLabel: 'dashboard group',
        label: function () {
            var menuPageNode = RED.nodes.node(this.menuPage);
            var menuItemNode = RED.nodes.node(menuPageNode.menuItem);
            var menuPageName = menuPageNode ? menuPageNode.name : 'label.unassigned';
            var menuItemName = menuItemNode ? menuItemNode.name : 'label.unassigned';

            return (
                '[' +
                (menuItemName || c_ur_group('label.menuItem')) +
                '] [' +
                (menuPageName || c_ur_group('label.menuPage')) +
                '] ' +
                (this.name || c_ur_group('label.group'))
            );
        },
        labelStyle: function () {
            return this.name ? 'node_label_italic' : '';
        },
        oneditprepare: function () {
            $('#node-input-size-lg').elementSizer({
                width: '#node-config-input-widthLg',
                auto: false,
            });
            $('#node-input-size-md').elementSizer({
                width: '#node-config-input-widthMd',
                auto: false,
            });
            $('#node-input-size-sm').elementSizer({
                width: '#node-config-input-widthSm',
                auto: false,
            });

            // $('#node-config-input-widthLg').val(this.widthLg);
            // $('#node-config-input-widthMd').val(this.widthMd);
            // $('#node-config-input-widthSm').val(this.widthSm);

            // $("#node-input-size").elementSizer({
            //     width: {
            //         lg: '#node-config-input-width-lg',
            //         md: '#node-config-input-width-md',
            //         sm: '#node-config-input-width-sm',
            //     },
            //     auto: false
            // });

            $('#node-config-input-disp').on('change', function () {
                if ($('#node-config-input-disp').is(':checked')) {
                    $('#group-collapse-flag').show();
                } else {
                    $('#group-collapse-flag').hide();
                    $('#node-config-input-collapse').prop('checked', false);
                }
            });
        },
    });
</script>

<script type="text/html" data-template-name="ur_group">
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> <span data-i18n="ur_group.label.name"></span></label>
        <input type="text" id="node-config-input-name">
    </div>
    <div class="form-row">
        <label for="node-config-input-menuPage"><i class="fa fa-table"></i> <span data-i18n="ur_group.label.menuPage"></span></label>
        <input type="text" id="node-config-input-menuPage">
    </div>
    <div class="form-row">
        <label for="node-config-input-width-row"><i class="fa fa-arrows-h"></i> <span data-i18n="ur_group.label.width"></span></label>

        <label for="node-config-input-widthLg" style="width: auto;"> <span data-i18n="ur_group.label.widthLg"></span></label>
        <input type="hidden" id="node-config-input-widthLg">
        <button class="editor-button" id="node-input-size-lg" style="margin-right: 7px;"></button>

        <label for="node-config-input-widthMd" style="width: auto;"> <span data-i18n="ur_group.label.widthMd"></span></label>
        <input type="hidden" id="node-config-input-widthMd">
        <button class="editor-button" id="node-input-size-md" style="margin-right: 7px;"></button>

        <label for="node-config-input-widthSm" style="width: auto;"> <span data-i18n="ur_group.label.widthSm"></span></label>
        <input type="hidden" id="node-config-input-widthSm">
        <button class="editor-button" id="node-input-size-sm" style="margin-right: 7px;"></button>
    </div>
    <div class="form-row">
        <input style="margin:8px 0 10px 102px; width:20px;" type="checkbox" checked id="node-config-input-disp"> <label style="width:auto" for="node-config-input-disp"><span data-i18n="ur_group.display-name"></span></label>
    </div>
    <div class="form-row" id="group-collapse-flag">
        <input style="margin:8px 0 10px 102px; width:20px;" type="checkbox" id="node-config-input-collapse"> <label style="width:auto" for="node-config-input-collapse"><span data-i18n="ur_group.collapse-name"></span></label>
    </div>
    <div class="form-row">
        <label for="node-config-input-access"><i class="fa fa-lock"></i> Access</label>
        <select id="node-config-input-access" style="width: 70%">
            <option value="">Default</option>
            <option value="1">Level 1 Viewer</option>
            <option value="2">Level 2 Limited Operator</option>
            <option value="3">Level 3 Standard Operator</option>
            <option value="4">Level 4 IT Operator</option>
            <option value="5">Level 5 Security Operator</option>
            <option value="6">Level 6 (reserved)</option>
            <option value="7">Level 7 (reserved)</option>
            <option value="8">Level 8 (reserved)</option>
            <option value="9">Level 9 Tech</option>
            <option value="10">Level 10 Admin</option>
        </select>
    </div>
</script>

<script type="text/html" data-help-name="ur_group">
    <p>Group</p>
</script>
